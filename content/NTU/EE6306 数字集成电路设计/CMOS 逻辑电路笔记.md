---
date: 2024-09-02 18:00
aliases: 
tags: 
publish: "true"
number headings: auto, first-level 1, max 5, contents ^toc, 1.1.
---
>[! info]
>《数字集成电路》第 6 章 CMOS 组合逻辑门
>《数字集成电路》第 7 章时序逻辑电路
>

# 1. 静态 CMOS 逻辑电路

每个时间点，门的输出都是连接在 $V_{DD}$ 或者 $V_{SS}$。电路的输出结果只和逻辑电路本身结构有关（不考虑开关期间的瞬态效应），也就是组合逻辑电路。

# 2. 动态 CMOS 逻辑电路

动态 CMOS 逻辑电路在伪 NMOS 逻辑电路的基础上，在地增加了一个 NMOS。

动态 CMOS 逻辑能够在避免静态功耗的同时，减少逻辑门的数量。通过增加时钟输入，能完成预充电和条件求值两个阶段。

>[! note]
>还有类似的只用 PUN 的电路，则是预放电，与使用 PDN 的电路相反。
>

## 2.1. 动态逻辑：基本原理

动态门具有和互补 CMOS 完全一样的 PDN。电路有两个工作阶段：**预充电和条件求值**，由时钟信号 CLK 决定。

![[动态门基本原理.png|300]]

### 2.1.1. 预充电

当 $CLK = 0$ 时，输出节点 Out 被 $M_{p}$ 预充电到 $V_{DD}$（由输出电容 $C_{L}$ 存储电荷），此时 $M_{e}$ 关闭，PDN 不工作。

$C_{L}$ 是结电容、布线电容以及扇出门输入电容的组合。

>[! note]
>求值 FET 消除了预充电期间的任何静态功耗，因为没有输入，求值 FET 始终关闭。
>

### 2.1.2. 求值

当 CLK=1 时预充电管 $M_{p}$ 关断, 求值管 $M_{e}$ 导通。输出根据输入值和下拉拓扑结构的情况有条件地放电。

如果输入使得 PDN 导通，那么输出和 GND 之间有低阻通路使得 $C_{L}$ 的电荷流失；如果 PDN 关断，预充电维持。

在求值器件，输出电容充电路径关断，其最多只能放电一次。 ^3e916e

>[! attention]
>注意, 在求值期间如果 PDN 关断, 则输出有可能处于高阻抗状态。这一特点与相应的静态门的情况截然不同, 静态门在输出和其中一条电源线之间总会存在一条低阻抗通路。
>

### 2.1.3. 动态逻辑门重要特性

- 静态 CMOS 完全一样的 PDN
- 全摆幅输出（$V_{OL}=GND,\ V_{OH}=V_{DD}$）
- 晶体管的数目 (对于复杂门) 明显少于静态情况: 为 $N+2$。  
- 是无比的逻辑门。PMOS 的尺寸仅仅影响自身的翻转时间和时钟功耗

>[! question] 
>为什么 PMOS 的尺寸会影响时钟功耗？
>

- 逻辑门只有动态功耗。
	- $V_{DD}$ 和 GND 之间没有直接通路
	- 比静态电路更高的输出转移概率（输入一定，输出不断跳动）
	- 动态功耗也可能高于静态 CMOS 电路。
- 动态逻辑门具有较快的开关速度
	- 第一个 (明显的) 原因是由于减少了每个门晶体管的数目, 并且每个扇入对前级只表现为一个负载晶体管, 因而降低了负载电容 $C_{load}$, 这相当于降低了逻辑努力。
	- 二个原因是动态门没有短路电流，并且由下拉器件提供的所有电流都用来对负载电容放电。
- 需要预充电/求值时钟

## 2.2. 动态逻辑的速度和功耗

根据前文的叙述可以知道，一旦完成预充电，输出信号总是为高电平，只要求值电路保持关闭，那么就不存在 $t_{pLH}$。只有当求值电路导通的时候，输出才会翻转。说明 $t_{pHL}$ 和 $C_{L}$ 以及 PDN 的吸电流的能力有关。

>[! attention]
>这里忽略了预充电时间对门的影响，这个由 $C_{L}$ 决定的。

## 2.3. 动态设计中的信号完整性问题

动态逻辑比静态逻辑有更高的性能。但是有以下几个重要问题需要考虑。

### 2.3.1. 电荷泄露

动态门的输出是存储在输出电容上的。由于存在漏电电流，电容的电荷会逐渐减少，最终使得这个门出错。

![[动态电路的漏电问题.png|400]]

上图是基本动态反相器电路的漏电来源。源 1 和来源 2 分别为 NMOS 下拉器件 $M_{1}$ 的反偏二极管和[[亚阈值漏电]]。注意，由于它的反偏二极管 (漏电来源 3) 和亚阈值导电 (漏电来源 4)，PMOS 预充电器件也引起一些漏电流。

由此可知，使用动态电路有一个最低的时钟频率，否则漏电会导致严重的输出错误。

在求值期间关断 PDN 使输出节点处于高电阻也会引起漏电。

漏电问题可以通过降低求值期间输出节点上的输出阻抗来解决。通常是增加一个泄漏晶体管，例如用一个带反馈（消除静态功耗）的伪 NMOS 型上拉器件来给电容补充电荷。

![[静态泄露器补偿电荷泄漏.png|400]]

当 CLK=0，且 PDN 关闭的时候，电容使得输出为高电平，从而使得泄漏器（bleeder）导通，电容补充电荷。如果 PDN 导通，电容电荷流失，则又会使得泄漏器关闭。

>[! question]
>那这里是否说明 PDN 的吸电流能力必须要比泄漏器更强呢，否则会导致泄漏器无法正常工作。

### 2.3.2. 电荷分享

![[动态电路中的电荷分享.png|300]]

对于上图中的电路而言，电荷分享就是指在某种情况下，$C_{L}$ 的电荷被 $C_{a}$ 和 $C_{b}$ 分享，导致 $C_{L}$ 的电荷量减小，输出电压减小。因为前面提到的[[#^3e916e|动态电路性质]]使得电压无法回复。

解决电荷再分布最常用也是最有效的办法是对关键的内部节点预充电，如使用一个 P1MOS 管连接 $V_{DD}$ 和电容。但是会增加面积和电容。

### 2.3.3. 电容耦合

输出节点较高的输出阻抗使得其容易被串扰影响，产生的电容耦合会破坏浮空节点的状态。另一个电容耦合的形式是背栅（backgate），即输出至输入耦合。

![[背栅耦合的例子.png|400]]



### 2.3.4. 时钟馈通

时钟的快速上升和下降会耦合到信号节点上。当 PDN 不导通时, 这一电容耦合会在时钟由低至高翻转时引起动态节点的输出上升到 $V_{DD}$ 以上。同样在时钟由高到低的时候，会导致



## 2.4. 串联动态门

直接串联动态门形成多级逻辑结构的方法并不可行。这个问题的关键就在于，在时钟从 0 到 1 的时候，$out_{1}$ 的电容放电需要时间，这个放电的过程会导致其串联的动态门的 NMOS 导通，从而给第二个动态门的输出创造了放电路径，使得输出电压降低，噪声容限降低并且功能出错。

![[动态电路串联.png|400]]

在预充电期间置所有的输入为 0 可以解决这个问题。这样在预充电之后下拉网络中所有的晶体管都被关断, 因此在求值期间不会发生存储电容的错误放电。

### 2.4.1. 多米诺逻辑

![[多米诺 CMOS 逻辑.png|400]]




## 2.5. np-CMOS



# 3. 时序 CMOS 电路

